# 卒論

## 1, 背景
IPAが発表している情報セキュリティ10大脅威では組織を狙った標的型攻撃による被害が1位となっています。
NIDSで広く使用されてきたシグネイチャ型では過去に経験した攻撃は用意に防ぐことができますが未知の脅威にはあまり効果を発揮しません。
特定の組織での通常通信とその組織向けの悪性通信を取得し機械学習に利用する機械学習型のNIDSシステムを提案します。

## 2, 関連研究
文献[1]ではデータセットとしてKDDCUP199と文献[2]によって指摘されているKDDCUP199の問題点を解決したNSL－KDDデータセットを訓練データとして使用している。また、文献[3]ではKDDCUP199の最新の攻撃傾向の反映ができていない等の問題を解決したkyotodata 2016 Datesetを使用している。この他にも様々なデータセット(mwsデータセット)を用いた機械学習を利用した侵入検知システムがあるがいくつかの問題点が考えられます。
まず、これらデータセットは公開されているものであり攻撃者も中身を確認することができるためAdversarial attacksの危険性があります。
次に、通常通信は各組織によって大きく異なる場合が多いため特定のデータセットを使用すると通常通信の誤検知率が高くなる可能性があります。既製品の機械学習型NIDSでは誤検知の登録が可能な製品はありますが、新しい機材やソフトを導入するたびに誤検知登録をするのではメンテナンスの負担が重くなってしまいます。
また、その誤検知率を低くするための研究はいくつか見られますが運用に関する研究はあまりされていません。実際の運用を考えた時、侵入された際対処も大事になります。**(ここの主張のために資料を追加できればよりよい)**

## 3, 提案

そこで本研究では特定の組織向けのデータセットを使用し、通常通信の逸脱と度合いから未知の通信かを判断することにより新しい攻撃手法への対応がしやすくさらにメンテナンスの負担が軽減されるような機械学習型のNIDSを検討します。提案手法のフローチャートを図1に示す。**(ここでフロー図を作成し、図で全体の流れを説明する)**まず、組織内の通常通信とハニーポットを設置しそこへ来る通信を既知の悪性通信として取得します。その際新しい機材やソフトを導入する場合はあらかじめそれらから出る通信データを取得しておき通常通信として加えます。それらすべての通信データから特徴量抽出します。そして、そのデータを使い機械学習を行うことによりNIDSの悪性通信の判別を可能とします。
3.1で正常通信の具体的な取得方法。3.2で既知の悪性通信の具体的な取得方法。3.3でそれら通信データから特徴量を抽出し学習する方法。3.4で新しい機材・ソフトの導入と内部通信に逸脱した通信を派遣した場合の対処方法をそれぞれ記述していきます。

### 3.1, 正常通信の取得 
監視組織内の通常通信を常時取得できる環境を作成します。これは組織内のPC間双方の通信を取得するものとして、各部署または組織通常通信が流れる大元のルーターにミラーリングポートを設定し、pcapデータフォーマットとして取得します。本実験では研究室内に流れる通常通信を研究室内のルーターにミラーリングポートを設定することで通常通信をpcapデータフォーマットとして取得します。

### 3.2, 既知の悪性通信の取得
監視組織内への悪性通信を常時取得できる環境を作成する。組織内にDMZを用意する。そこにハニーポットを設置し、ハニーポットに対して行われる通信を既知の悪性通信としpcapデータフォーマットとしてて取得します。本実験ではハニーポット専用のネットワークを作成します。その中のハニーポットへ行われる通信をすべてpcapデータフォーマットとして取得します。

### 3.3, 通信データから特徴量の抽出・学習方法
特徴量の抽出方法としてbroと呼ばれるソフトウェアのプラグインを使用します。これを使用することでpcapデータをcsv形式の特徴量ファイルに変換を行ってくれます。それを利用して特徴量データを取得、学習をします。**(学習方法の部分は林さんと連絡をとり加筆していきます。)**

### 3,4, 新しい機材・ソフトの導入と内部通信に逸脱した通信を派遣した場合の対処
組織内に侵入したマルウェアや内部の犯行による悪性通信を検知した場合や新しいソフトが出した未知の通信を解析するために、組織内に解析用ネットワークを用意します。その未知の通信を検知した場合。そのPCまたはネットワークを隔離し解析用ネットワークへと移動させます。**(このあたりがまだ曖昧です。ネットワークブートするようなタイプでは状態を保存し解析用ネットワークへの以降は簡単ですが、たいていの会社はPCに対し物理的にOSをいれていると思うのでその辺への対処法を考えておきます。)**外部とのネットワークを遮断し内部への害を排除した状態でそのPCからでる通信をすべて取得し、人の手による判別を行います。未知の正常通信であった場合


## 参考
[1] ニューラルネットワークを用いた侵入検知システム改良手法の検討
[2] a detailed analysis of the kdd cpu 00 data set
[3] 機械学習を用いた攻撃検知に関する学習手法の精度評価



